# ============================================
# AI-EOS Environment Configuration
# Complete template for all required settings
# ============================================
# 
# SETUP INSTRUCTIONS:
# 1. Copy this file: cp .env.example .env
# 2. Fill in your actual API keys
# 3. NEVER commit .env to git (it's in .gitignore)
# 4. Get keys from URLs in comments below
#
# ============================================


# ============================================
# ğŸ”¥ CRITICAL - MUST CONFIGURE FIRST
# ============================================

# LangSmith (Observability - REQUIRED)
# Get key: https://smith.langchain.com/settings
# Free tier: 5,000 traces/month
LANGCHAIN_TRACING_V2=true
LANGCHAIN_API_KEY=lsv2_pt_your_key_here
LANGCHAIN_PROJECT=ai-eos-production
LANGCHAIN_ENDPOINT=https://api.smith.langchain.com


# ============================================
# ğŸ¤– LLM PROVIDERS
# ============================================

# OpenAI (GPT models - for testing)
# Get key: https://platform.openai.com/api-keys
# Cost: $0.15/1M input tokens (gpt-4o-mini)
# Recommended for: Testing, embeddings
OPENAI_API_KEY=sk-proj-your_key_here

# Google Gemini (PRIMARY - FREE TIER)
# Get key: https://aistudio.google.com/app/apikey  
# FREE: 1,500 requests/day (Gemini 2.0 Flash)
# Recommended for: 90% of requests (cost optimization)
GOOGLE_API_KEY=your_gemini_key_here
GEMINI_MODEL=gemini-2.0-flash-exp

# Anthropic Claude (PREMIUM)
# Get key: https://console.anthropic.com/
# Cost: $3/1M input, $15/1M output (Claude Sonnet)
# Recommended for: Arbiter only (10% of requests)
ANTHROPIC_API_KEY=sk-ant-your_key_here
ANTHROPIC_MODEL=claude-3-7-sonnet-20250219


# ============================================
# ğŸ”§ TOOLS & SERVICES (Get in Week 3)
# ============================================

# Tavily (Web search)
# Get key: https://tavily.com/
# FREE: 1,000 searches/month
# Recommended for: Research agents
TAVILY_API_KEY=tvly-your_key_here

# Cohere (Optional - for reranking)
# Get key: https://dashboard.cohere.com/api-keys
# FREE: 1,000 requests/month
COHERE_API_KEY=your_cohere_key_here

# Exa (Optional - alternative search)
# Get key: https://exa.ai/
EXA_API_KEY=exa-your_key_here


# ============================================
# ğŸ§  LETTA (Memory System)
# ============================================

# Letta Server
# Start with: letta server
LETTA_SERVER_URL=http://localhost:8283
LETTA_SERVER_PORT=8283

# Memory Configuration
LETTA_ENABLE_SLEEP_COMPUTE=true
LETTA_SLEEP_COMPUTE_INTERVAL=3600  # seconds (1 hour)
LETTA_MEMORY_CONSOLIDATION=true
LETTA_CONTRADICTION_DETECTION=true


# ============================================
# ğŸ—„ï¸ DATABASES (Setup in Week 7)
# ============================================

# PostgreSQL (Supabase - for checkpointing)
# Get URL: https://supabase.com/ 
# FREE tier: 500MB database
POSTGRES_URL=postgresql://user:pass@host:5432/aieos
POSTGRES_POOL_SIZE=20
POSTGRES_MAX_OVERFLOW=10

# Redis (Upstash - for session state)
# Get URL: https://upstash.com/
# FREE tier: 10,000 commands/day
REDIS_URL=redis://default:pass@host:6379
REDIS_MAX_CONNECTIONS=50
REDIS_CACHE_TTL=3600  # seconds (1 hour)


# ============================================
# âš™ï¸ AGENT CONFIGURATION
# ============================================

# Agent Behavior
MAX_ITERATIONS=50
MAX_EXECUTION_TIME=300  # seconds (5 minutes)
ENABLE_THINKING_TOOL=true

# Multi-Agent Debate
ENABLE_MULTI_AGENT=true
ENABLE_ROUND_2=true
ROUND_2_CONSENSUS_THRESHOLD=0.75  # Skip R2 if consensus > 75%
META_CONFIDENCE_THRESHOLD=0.85    # High confidence threshold

# Model Assignment (which LLM for which agent)
MASTER_MODEL=claude-3-7-sonnet-20250219
ANALYST_MODEL=gemini-2.0-flash-exp
STRATEGIST_MODEL=gemini-2.0-flash-exp  
CRITIC_MODEL=gemini-2.0-flash-exp


# ============================================
# ğŸš€ PERFORMANCE & OPTIMIZATION
# ============================================

# Caching
ENABLE_NODE_CACHING=true
CACHE_TTL=3600  # seconds (1 hour)
ENABLE_PROMPT_CACHING=true  # Anthropic prompt caching

# Concurrency
MAX_CONCURRENT_AGENTS=4
MAX_CONCURRENT_TOOLS=3

# Deferred Nodes (parallel execution)
ENABLE_DEFERRED_NODES=true
MAX_DEFERRED_DEPTH=3


# ============================================
# ğŸ’° COST CONTROL
# ============================================

# Budget Limits
MAX_COST_PER_QUERY=0.50       # USD
MAX_DAILY_COST=10.00          # USD  
MAX_MONTHLY_COST=200.00       # USD
ENABLE_COST_ALERTS=true

# Testing (use free models)
USE_FREE_TIER_FOR_TESTS=true
USE_FREE_TIER_FOR_JUDGES=true

# Fallback Strategy
ENABLE_FALLBACK_CASCADE=true  # Gemini â†’ GPT â†’ Claude
MAX_RETRIES=3
RETRY_DELAY=2  # seconds


# ============================================
# ğŸ‡®ğŸ‡· PERSIAN OPTIMIZATION
# ============================================

# Language Settings
DEFAULT_LANGUAGE=fa
ENABLE_RTL=true
PERSIAN_DATE_FORMAT=jalali

# Quality Control
ENABLE_PERSIAN_AUTO_CORRECTION=true
ENABLE_PERSIAN_NUMBER_FORMATTING=true
PERSIAN_QUALITY_THRESHOLD=8.0  # 0-10 scale

# Cultural Context
BUSINESS_HOURS=09:00-17:00  # Tehran time
WEEKEND_DAYS=Friday
CURRENCY_FORMAT=IRR
EXAMPLE_COMPANIES=Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§,Ø§Ø³Ù†Ù¾,ØªÙ¾Ø³ÛŒ


# ============================================
# ğŸ”’ SECURITY (Setup in Week 7)
# ============================================

# Input Validation
ENABLE_PROMPT_INJECTION_DETECTION=true
ENABLE_PII_SCRUBBING=true
MAX_INPUT_LENGTH=10000  # characters

# Rate Limiting
ENABLE_RATE_LIMITING=true
RATE_LIMIT_REQUESTS=100  # per hour per IP
RATE_LIMIT_WINDOW=3600   # seconds (1 hour)

# Authentication (for production)
ENABLE_AUTH=false
JWT_SECRET=your_jwt_secret_here
JWT_EXPIRATION=86400  # seconds (24 hours)


# ============================================
# ğŸ“Š MONITORING & ALERTS
# ============================================

# Error Tracking
ENABLE_ERROR_TRACKING=true
ERROR_AMPLIFICATION_THRESHOLD=4.5  # Google/MIT threshold
ERROR_RATE_THRESHOLD=0.01          # 1% error rate

# Performance Monitoring  
ENABLE_LATENCY_TRACKING=true
P95_LATENCY_THRESHOLD=30  # seconds
P99_LATENCY_THRESHOLD=60  # seconds

# Alerts (configure in Week 7)
ALERT_EMAIL=your_email@example.com
ALERT_SLACK_WEBHOOK=https://hooks.slack.com/...
ENABLE_PAGERDUTY=false
PAGERDUTY_KEY=your_pagerduty_key_here

# Health Checks
HEALTH_CHECK_INTERVAL=60  # seconds (1 minute)
ENABLE_UPTIME_MONITORING=true


# ============================================
# ğŸ§ª TESTING & DEVELOPMENT
# ============================================

# Test Configuration
TEST_MODE=false
ENABLE_MOCK_LLMS=false  # Use mock LLMs for testing
TEST_TRACE_SAMPLING=1.0  # 100% of test traces

# Development
DEBUG=false
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR
ENABLE_VERBOSE_LOGGING=false

# Bespoke Testing
ENABLE_LLM_AS_JUDGE=true
JUDGE_MODEL=gemini-2.0-flash-exp  # Use free tier
TEST_COVERAGE_THRESHOLD=80  # percent


# ============================================
# ğŸŒ DEPLOYMENT (Week 10-12)
# ============================================

# Environment
ENVIRONMENT=development  # development, staging, production
PORT=8000
HOST=0.0.0.0

# Railway/Vercel (production deployment)
RAILWAY_TOKEN=your_railway_token_here
VERCEL_TOKEN=your_vercel_token_here

# Domain
BASE_URL=http://localhost:8000
FRONTEND_URL=http://localhost:3000

# CORS
ENABLE_CORS=true
ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com

# CI/CD
GITHUB_TOKEN=your_github_token_here
ENABLE_AUTO_DEPLOY=false


# ============================================
# ğŸ“ˆ ANALYTICS (Optional)
# ============================================

# PostHog (FREE tier)
POSTHOG_API_KEY=your_posthog_key_here
POSTHOG_HOST=https://app.posthog.com

# Mixpanel (Optional)
MIXPANEL_TOKEN=your_mixpanel_token_here

# Google Analytics (Optional)
GA_TRACKING_ID=UA-your_tracking_id_here


# ============================================
# ğŸ’³ PAYMENT (Week 11 - Iranian users)
# ============================================

# Zarinpal (Iranian payment gateway)
ZARINPAL_MERCHANT_ID=your_merchant_id_here
ZARINPAL_SANDBOX=true  # false for production

# IDPay (Alternative)
IDPAY_API_KEY=your_idpay_key_here


# ============================================
# ğŸ¨ UI/UX (Week 8-9)
# ============================================

# CopilotKit
COPILOTKIT_API_KEY=your_copilotkit_key_here
ENABLE_STREAMING=true
ENABLE_THINKING_TRAIL=true

# Frontend
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_WS_URL=ws://localhost:8000/ws


# ============================================
# ğŸ“ NOTES
# ============================================
#
# Priority order for setup:
# 1. LangSmith (CRITICAL - Day 1)
# 2. OpenAI OR Gemini (at least one)
# 3. Letta server (Week 1)
# 4. Tavily (Week 3 - research agents)
# 5. Anthropic (Week 4 - arbiter)
# 6. Databases (Week 7 - production)
# 7. Everything else (as needed)
#
# Cost optimization:
# - Use Gemini FREE tier for 90% of requests
# - Enable node caching (19x speedup)
# - Enable prompt caching (90% savings)
# - Skip Round 2 when meta-confidence > 85%
# - Target: <$0.15 per query
#
# Security:
# - NEVER commit .env to git
# - Rotate keys monthly
# - Use separate keys for dev/staging/prod
# - Enable rate limiting in production
#
# ============================================